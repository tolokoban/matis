# MATIS <small>_Multi-level Asynchrounous Tools Interconnection System_</small>

Fast complex asynchrounous processes made easy.

----

<img src="data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%20%3Csvg%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.0%22%20width%3D%22800%22%20height%3D%22300%22%20preserveAspectRatio%3D%22xMidYMid%20meet%22%20viewBox%3D%220%200%201600%20300%22%3E%20%3Cg%20stroke-width%3D%223%22%20stroke%3D%22%23070%22%3E%20%3Cpath%20d%3D%22M0%2C150H200%22%2F%3E%20%3Cpath%20d%3D%22M1400%2C150h200%22%2F%3E%20%3Cpath%20d%3D%22M600%2C100h400%22%2F%3E%20%3Cpath%20d%3D%22M600%2C200h400%22%2F%3E%20%3C%2Fg%3E%20%3Cg%20stroke%3D%22%23007%22%20fill%3D%22%2300f%22%20stroke-width%3D%2210%22%3E%20%3Ccircle%20cx%3D%22175%22%20cy%3D%22150%22%20r%3D%2225%22%20%2F%3E%20%3Ccircle%20cx%3D%22975%22%20cy%3D%22100%22%20r%3D%2225%22%20%2F%3E%20%3Ccircle%20cx%3D%22975%22%20cy%3D%22200%22%20r%3D%2225%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20stroke%3D%22%23700%22%20fill%3D%22%23f00%22%20stroke-width%3D%2210%22%3E%20%3Ccircle%20cx%3D%221425%22%20cy%3D%22150%22%20r%3D%2225%22%20%2F%3E%20%3Ccircle%20cx%3D%22625%22%20cy%3D%22100%22%20r%3D%2225%22%20%2F%3E%20%3Ccircle%20cx%3D%22625%22%20cy%3D%22200%22%20r%3D%2225%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20stroke%3D%22%23000%22%20fill%3D%22%23777%22%20stroke-width%3D%2210%22%3E%20%3Crect%20x%3D%22200%22%20y%3D%2250%22%20width%3D%22400%22%20height%3D%22200%22%3E%20%3Canimate%20id%3D%22T1_V1a%22%20begin%3D%22V1a_move.end%22%20dur%3D%220.5s%22%20attributeName%3D%22fill%22%20attributeType%3D%22XML%22%20values%3D%22%23777%3B%23cc9%3B%23777%22%20%2F%3E%20%3Canimate%20id%3D%22T1_V1b%22%20begin%3D%22V1b_move.end%22%20dur%3D%220.5s%22%20attributeName%3D%22fill%22%20attributeType%3D%22XML%22%20values%3D%22%23777%3B%23cc9%3B%23777%22%20%2F%3E%20%3Canimate%20id%3D%22T1_V1c%22%20begin%3D%22V1c_move.end%22%20dur%3D%220.5s%22%20attributeName%3D%22fill%22%20attributeType%3D%22XML%22%20values%3D%22%23777%3B%23cc9%3B%23777%22%20%2F%3E%20%3Canimate%20id%3D%22T1_V1d%22%20begin%3D%22V1d_move.end%22%20dur%3D%220.5s%22%20attributeName%3D%22fill%22%20attributeType%3D%22XML%22%20values%3D%22%23777%3B%23cc9%3B%23777%22%20%2F%3E%20%3C%2Frect%3E%20%3Crect%20x%3D%221000%22%20y%3D%2250%22%20width%3D%22400%22%20height%3D%22200%22%3E%20%3Canimate%20id%3D%22T2_V2a%22%20begin%3D%22V2c_move.end%22%20dur%3D%220.5s%22%20attributeName%3D%22fill%22%20attributeType%3D%22XML%22%20values%3D%22%23777%3B%23cc9%3B%23777%22%20%2F%3E%20%3Canimate%20id%3D%22T2_V2b%22%20begin%3D%22V2d_move.end%22%20dur%3D%220.5s%22%20attributeName%3D%22fill%22%20attributeType%3D%22XML%22%20values%3D%22%23777%3B%23cc9%3B%23777%22%20%2F%3E%20%3C%2Frect%3E%20%3C%2Fg%3E%20%3Cg%20stroke%3D%22none%22%20fill%3D%22%23ffe%22%20text-anchor%3D%22middle%22%20font-size%3D%2280%22%20font-family%3D%22sans-serif%22%3E%20%3Ctext%20x%3D%22400%22%20y%3D%22170%22%3ESwitch%3C%2Ftext%3E%20%3Ctext%20x%3D%221200%22%20y%3D%22170%22%3EConcat%3C%2Ftext%3E%20%3C%2Fg%3E%20%20%3Cg%20stroke%3D%22%23770%22%20stroke-width%3D%222%22%20fill%3D%22%23770%22%20text-anchor%3D%22middle%22%20font-size%3D%2240%22%20font-family%3D%22monospace%22%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3EF%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V1a_move%22%20begin%3D%220s%3BV3b_move.end%22%20dur%3D%222s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22-50%2C140%22%20to%3D%22130%2C140%22%2F%3E%20%3Canimate%20id%3D%22V1a_on%22%20begin%3D%22V1a_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V1a_off%22%20begin%3D%22V1a_move.end%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3ER%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V1b_move%22%20begin%3D%22V1a_move.end%22%20dur%3D%222s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22-50%2C140%22%20to%3D%22130%2C140%22%2F%3E%20%3Canimate%20id%3D%22V1b_on%22%20begin%3D%22V1b_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V1b_off%22%20begin%3D%22V1b_move.end%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3EA%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V1c_move%22%20begin%3D%22V1b_move.end%22%20dur%3D%222s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22-50%2C140%22%20to%3D%22130%2C140%22%2F%3E%20%3Canimate%20id%3D%22V1c_on%22%20begin%3D%22V1c_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V1c_off%22%20begin%3D%22V1c_move.end%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3E%C3%89%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V1d_move%22%20begin%3D%22V1c_move.end%22%20dur%3D%222s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22-50%2C140%22%20to%3D%22130%2C140%22%2F%3E%20%3Canimate%20id%3D%22V1d_on%22%20begin%3D%22V1d_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V1d_off%22%20begin%3D%22V1d_move.end%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3C%2Fg%3E%20%20%3Cg%20stroke%3D%22%23707%22%20stroke-width%3D%222%22%20fill%3D%22%23707%22%20text-anchor%3D%22middle%22%20font-size%3D%2240%22%20font-family%3D%22monospace%22%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3EF%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V2a_move%22%20begin%3D%22T1_V1a.end%22%20dur%3D%221.5s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22650%2C90%22%20to%3D%22930%2C90%22%2F%3E%20%3Canimate%20id%3D%22V2a_on%22%20begin%3D%22V2a_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V2a_off%22%20begin%3D%22V2c_off.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3ER%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V2b_move%22%20begin%3D%22T1_V1b.end%22%20dur%3D%221.5s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22650%2C90%22%20to%3D%22900%2C90%22%2F%3E%20%3CanimateTransform%20id%3D%22V2b_move%22%20begin%3D%22V2a_off.end%22%20dur%3D%220.3s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22900%2C90%22%20to%3D%22930%2C90%22%2F%3E%20%3Canimate%20id%3D%22V2b_on%22%20begin%3D%22V2b_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V2b_off%22%20begin%3D%22V2d_off.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3EA%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V2c_move%22%20begin%3D%22T1_V1c.end%22%20dur%3D%221.5s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22650%2C190%22%20to%3D%22930%2C190%22%2F%3E%20%3Canimate%20id%3D%22V2c_on%22%20begin%3D%22V2c_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V2c_off%22%20begin%3D%22V2c_move.end%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3E%C3%89%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V2d_move%22%20begin%3D%22T1_V1d.end%22%20dur%3D%221.5s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%22650%2C190%22%20to%3D%22930%2C190%22%2F%3E%20%3Canimate%20id%3D%22V2d_on%22%20begin%3D%22V2d_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V2d_off%22%20begin%3D%22V2d_move.end%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3C%2Fg%3E%20%20%3Cg%20stroke%3D%22%23077%22%20stroke-width%3D%222%22%20fill%3D%22%23077%22%20text-anchor%3D%22middle%22%20font-size%3D%2240%22%20font-family%3D%22monospace%22%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3E(Fa)%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V3a_move%22%20begin%3D%22T2_V2a.end%22%20dur%3D%221s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%221450%2C140%22%20to%3D%221560%2C140%22%2F%3E%20%3Canimate%20id%3D%22V3a_on%22%20begin%3D%22V3a_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V3a_off%22%20begin%3D%22V3b_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3Cg%20opacity%3D%220%22%3E%20%3Ctext%20x%3D%220%22%20y%3D%220%22%3E(R%C3%A9)%3C%2Ftext%3E%20%3CanimateTransform%20id%3D%22V3b_move%22%20begin%3D%22T2_V2b.end%22%20dur%3D%221s%22%20fill%3D%22freeze%22%20attributeName%3D%22transform%22%20attributeType%3D%22XML%22%20type%3D%22translate%22%20from%3D%221450%2C140%22%20to%3D%221560%2C140%22%2F%3E%20%3Canimate%20id%3D%22V3b_on%22%20begin%3D%22V3b_move.begin%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%220%22%20to%3D%221%22%20%2F%3E%20%3Canimate%20id%3D%22V3b_off%22%20begin%3D%22V3b_move.end%20%2B%202s%22%20dur%3D%220.3s%22%20attributeName%3D%22opacity%22%20attributeType%3D%22XML%22%20fill%3D%22freeze%22%20from%3D%221%22%20to%3D%220%22%20%2F%3E%20%3C%2Fg%3E%20%3C%2Fg%3E%20%20%3C%2Fsvg%3E%20' />


## Example

```text
                           |
                           | path
                      +----------+
                      | loadBody |
                      +----------+
                    path |    | text
                         |    |
                 +-------+--( | )----------+
                 |            |            |
            path |            |            | path
        +------------------+  |  +------------------+
        | changeExtForHead |  |  | changeExtForFoot |
        +------------------+  |  +------------------+
        path |                |              | path
             |                |              |
        path |                |              | path
       +------------+         |         +------------+
       | existsHead |         |         | existsFoot |
       +------------+         |         +------------+
       no |       | yes       |       yes |       | no
          |       |           |           |       |
     void |       | path      |      path |       | void
+-----------+   +----------+  |  +----------+   +-----------+
| constHead |   | loadHead |  |  | loadHead |   | constHead |
+-----------+   +----------+  |  +----------+   +-----------+
     text |       | text      |      text |       | text
          |       |           |           |       |
          +---+---+           |           +---+---+
              |               |               |
              +------------+  |  +------------+
                           |  |  |
                           | b|  | 
                           | o|  |
                           | d|  |
                      head | y|  | foot
                         +--------+
                         | concat |
                         +--------+
                             | text
                             |
```


```js
var Matis = require("async-tools");

// Create tools.
var loadBody = Matis.tools.LoadText('utf-8');
var loadHead = Matis.tools.LoadText('utf-8');
var loadFoot = Matis.tools.LoadText('utf-8');
var changeExtForHead = Matis.tools.ChangeExtension({js: "head"});
var changeExtForFoot = Matis.tools.ChangeExtension({js: "foot"});
var existsHead = Matis.tools.ExistsFile();
var existsFoot = Matis.tools.ExistsFile();
var constHead = Matis.tools.Constant("// Missing header.\n");
var constFoot = Matis.tools.Constant("// Missing footer.\n");
var concat = Matis.tools.ConcatStrings(['head', 'body', 'foot']);

// Link tools.
loadBody.link('text', concat, 'body');
loadBody.link('path', changeExtForHead).link(existsHead).link('yes', loadHead).link('text', concat, 'head');
loadBody.link('path', changeExtForFoot).link(existsFoot).link('yes', loadFoot).link('text', concat, 'foot');
existsHead.link('no', constHead).link(concat, 'head');
existsFoot.link('no', constFoot).link(concat, 'foot');

// Execute.
loadBody.exec(
    { path: 'myfile.js' },
    function (output) {
        console.log("Result is: " + output.text);
    },
    function (err) {
        console.error("Error: " + err);
    }
);
```

## Build-in tools

While it's easy to write your own tools, we provide a list of generic build-in tools which can help you quickly prototype your processes.



<a name='Matis.tools.ChangeExtension'></a>
### Matis.tools.ChangeExtension


An extension is the string after the last occurence of a dot (`.`) in
a `path`.   This tool replaces  extensions with other one.   It never
fails: the `reject` function will never be called.

@param {object}  extensions -  Each attribute  name is  replaced with
it's  value. For  instance `{js:  'head'}` means  than the  extension
`.js`  must  be  replaced  with `.head`.  Other  files  names  remain
unchanged.


<a name='Matis.tools.ConcatStrings'></a>
### Matis.tools.ConcatStrings


Concat all the inputs in one output. 

@param {array[string]} inputs - Array inputs' names.

* __input__: Thisn tool has a variable number of inputs specified by the `inputs` argument.
* __output__
    * {string} `text` - The resulting concatenated string.


<a name='Matis.tools.ConsoleLog'></a>
### Matis.tools.ConsoleLog


This tool is used for debug  purpose. The input is displayed with the
`console.log()` function, then sent to the output unchanged.


<a name='Matis.tools.Constant'></a>
### Matis.tools.Constant


Constants cas be used in many cases, such as default values.

* __argument__: the constant value this tool will always emit.
* __input__
    * {any} `void` - This input is just a trigger. It's value is ignored.
* __output__
    * {any} `value` - A constant value defined by the `value` argument.


<a name='Matis.tools.ExistsFile'></a>
### Matis.tools.ExistsFile


If  `path`  exists and  is  a  file, emit  it  on  the `yes`  output,
otherwise, emit it on the `no`.

* __input__
    * {string} path - Path of the file we want know if it exists.
* __output__
    * {string} yes - Path of the file if it exists.
    * {string} no - Path of the file if it does not exist.


<a name='Matis.tools.ForEach'></a>
### Matis.tools.ForEach


* __argument__:
    * {array[string]} `input`: Array of inputs' names. The first one is the array over which we will loop.
    * {array[string]} `output`: Array of outputs' names. They all are arrays.
    * {Tool} `tool`:


<a name='Matis.tools.Join'></a>
### Matis.tools.Join


Join all elements of an array with a `glue`.

* __param__ 
    * {string} glue - Text to add between two elements of the `array`.
* __input__
    * {array[string]} `array` - Array of strings to join with the `glue`.
* __output__
    * {string} `text` - The resulting joined array..


<a name='Matis.tools.LoadStream'></a>
### Matis.tools.LoadStream



@param  {object|string}   options  -  As   a  string,  this   is  the
encoding. Otherwise, it  has the same meaning as the  argument in the
[`fs.readFile(filename[, options], callback)`](https://nodejs.org/dist/latest-v4.x/docs/api/fs.html#fs_fs_readfile_filename_options_callback) function.


<a name='Matis.tools.LoadText'></a>
### Matis.tools.LoadText



@param  {object|string}   options  -  As   a  string,  this   is  the
encoding. Otherwise, it  has the same meaning as the  argument in the
[`fs.readFile(filename[, options], callback)`](https://nodejs.org/dist/latest-v4.x/docs/api/fs.html#fs_fs_readfile_filename_options_callback) function.


<a name='Matis.tools.MatchRegexp'></a>
### Matis.tools.MatchRegexp


This tool is used for debug  purpose. The input is displayed with the
`console.log()` function, then sent to the output unchanged.


<a name='Matis.tools.ReadDir'></a>
### Matis.tools.ReadDir


* Return an array of files' names contained in the folder `path`.
* 
* * __input__
*     * {string} `path` - Path from where to list existing files.
* * __output__
* * {array[string]} `files`  - Array of the  names of the files  in the
        directory excluding `'.'` and `'..'`.


<a name='Matis.tools.SaveText'></a>
### Matis.tools.SaveText



@param  {object|string}   options  -  As   a  string,  this   is  the
encoding. Otherwise, it  has the same meaning as the  argument in the
[`fs.readFile(filename[, options], callback)`](https://nodejs.org/dist/latest-v4.x/docs/api/fs.html#fs_fs_readfile_filename_options_callback) function. Default is `utf8`.


<a name='Matis.tools.SvgToDataurl'></a>
### Matis.tools.SvgToDataurl


Transform an SVG source into a DataURL ready to use in an image.
